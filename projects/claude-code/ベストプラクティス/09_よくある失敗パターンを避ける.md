# よくある失敗パターンを避ける

## 概要

Claude Codeを使っていると、誰もが陥りがちな失敗パターンがある。これらを認識し、事前に対策することで、より効果的にClaudeを活用できる。

---

## 失敗パターン一覧

| パターン | 問題 | 解決策 |
|----------|------|--------|
| **キッチンシンク・セッション** | 無関係なタスクがコンテキストをノイズで埋める | 無関係なタスク間で`/clear`を実行 |
| **繰り返しの修正** | 失敗したアプローチがコンテキストを汚染 | 2回失敗したら: `/clear` + より良いプロンプト |
| **過剰なCLAUDE.md** | 長いファイルで重要なルールが無視される | 容赦なく削減、自明なプラクティスは削除 |
| **信頼してから検証のギャップ** | もっともらしいコードにエッジケースのバグ | 常に検証を提供（テスト、スクリプト、スクリーンショット） |
| **無限の探索** | 調査プロンプトが数百のファイルを読む | スコープを狭くするか、サブエージェントを使う |

---

## 詳細解説

### キッチンシンク・セッション

```
悪い例:
「ログイン機能を実装して」→ 完了
「データベースのバックアップスクリプトを書いて」→ 完了
「CSSのバグを直して」→ コンテキストがごちゃ混ぜ
```

```
良い例:
「ログイン機能を実装して」→ 完了
/clear
「データベースのバックアップスクリプトを書いて」→ 完了
/clear
「CSSのバグを直して」
```

### 繰り返しの修正

```
悪い例:
「ES Modulesを使って」→ CommonJSで書かれる
「だからES Modulesで」→ また間違える
「import/exportを使って」→ まだ間違える...
```

```
良い例:
「ES Modulesを使って」→ CommonJSで書かれる
「だからES Modulesで」→ まだ間違える

/clear

「ES Modules構文（import/export）でモジュールを書いて。
require()は絶対に使わないこと。
例: import { foo } from './bar.js'」
```

### 過剰なCLAUDE.md

```
悪い例:
# コードスタイル
- インデントは2スペース
- セミコロンを使う
- シングルクォートを使う
- ... (50行続く)
```

```
良い例:
# 重要なルール
- ES Modules構文を使用（CommonJS禁止）
- テストは`npm test -- --watch=false`で実行
```

### 信頼してから検証のギャップ

```
悪い例:
「メールバリデーション関数を書いて」
→ 実装を受け取る
→ そのまま使う
→ 本番で「user@.com」が通ってしまう
```

```
良い例:
「メールバリデーション関数を書いて。
テストケース:
- user@example.com → true
- invalid → false
- user@.com → false

テストを書いて実行して」
```

### 無限の探索

```
悪い例:
「このコードベースを調査して、問題点を報告して」
→ 何百ものファイルを読み始める
```

```
良い例:
「src/auth/ディレクトリを調査して、
セキュリティ上の懸念点を報告して」

または:

「サブエージェントを使って認証モジュールを調査して。
特にトークン処理に焦点を当てて」
```

---

## まとめ

> 「失敗パターンを知ることは、成功パターンを知ることと同じくらい重要」

キッチンシンク・セッション、繰り返しの修正、過剰なCLAUDE.md、検証の欠如、無限の探索—これらの失敗パターンを認識し、事前に対策しよう。
