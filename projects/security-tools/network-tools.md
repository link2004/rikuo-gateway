# ネットワークを透視する

あなたの会社のネットワークには、今この瞬間、何台のデバイスが接続されているだろうか。

それぞれのデバイスで、どんなサービスが動いているか。どのポートが開いているか。どんな通信が行われているか。

答えられないなら、あなたは自分の家の鍵がいくつあるか知らないのと同じだ。

---

## Nmap — ネットワークの地図を描く

1997年、Gordon Lyon（通称Fyodor）は一つのツールを世に送り出した。

Nmap。Network Mapperの略。

IPアドレスの範囲を指定すれば、そこに存在するすべてのデバイスを発見する。各デバイスで開いているポートを特定する。動いているサービスとそのバージョンを推測する。

映画『マトリックス リローデッド』でトリニティが使っていたのもNmapだ。ハリウッドが「本物のハッキングツール」として選んだ。それほど、このツールは象徴的な存在になった。

> 「Nmapがなければ、ペネトレーションテストは始まらない」

攻撃者がまずやることは、ターゲットの「地図」を描くこと。防御者も同じだ。自分のネットワークの地図を持っていなければ、何を守るべきかすらわからない。

---

## Wireshark — パケットの顕微鏡

ネットワーク上を流れるデータは、すべて「パケット」という小さな塊に分割されている。

Wiresharkは、そのパケットを一つ一つ捕まえて、中身を見せてくれる。

誰が誰と通信しているか。何を送っているか。暗号化されていなければ、パスワードすら見える。

1998年にGerald Combs氏が開発したこのツールは、もともと「Ethereal」という名前だった。商標問題で改名したが、その強力さは変わらない。

> 「ログは嘘をつくことがある。しかしパケットは嘘をつかない」

ネットワークエンジニア、セキュリティアナリスト、トラブルシューティングの達人。彼らは皆、Wiresharkを使う。

---

## Nessus — 脆弱性のカタログ

Nmapがネットワークの「地図」を描くなら、Nessusは「どこが壊れているか」を教えてくれる。

1998年、当時17歳だったRenaud Deraison氏が開発したこの脆弱性スキャナーは、今やTenable社の主力製品となり、企業のセキュリティ対策に欠かせない存在となった。

Nessusは膨大な脆弱性データベースを持っている。68,000以上のチェック項目。既知の脆弱性、設定ミス、デフォルトパスワード。それらを一つ一つ確認し、レポートにまとめてくれる。

「うちのネットワークは安全です」

その言葉を言う前に、Nessusを走らせてみるといい。

---

## Masscan — 光速のスキャナー

Nmapは正確だが、遅い。インターネット全体をスキャンするには、何年もかかる。

Robert Graham氏は考えた。「もっと速くできないか」

Masscanが生まれた。

理論上、インターネット全体を6分でスキャンできる。毎秒1000万パケット以上を送信する。精度は落ちるが、大規模な偵察には最適だ。

攻撃者は、こういうツールで広大なインターネットを探索している。

---

## これらのツールで何ができるのか

- ネットワーク上のすべてのデバイスを発見する
- 各デバイスで開いているポートとサービスを特定する
- ネットワーク上を流れるすべての通信を傍受・解析する
- 既知の脆弱性や設定ミスを自動的に検出する

知らないデバイスが見つかることもある。

忘れられた古いサーバー。誰かが勝手に接続したルーター。それらが、攻撃の入り口になっていることは珍しくない。

まず、自分のネットワークを知ること。すべてはそこから始まる。
