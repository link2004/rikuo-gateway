# 穴を通り抜ける

脆弱性を見つけることと、それを実際に悪用することは、まったく別の話だ。

穴があることを知っているのと、その穴を通り抜けられるのとでは、意味が違う。エクスプロイトフレームワークは、その「通り抜ける」部分を担当する。

---

## Metasploit — エクスプロイトの民主化

2003年以前、エクスプロイトコードは秘伝のタレのようなものだった。

セキュリティ研究者たちが個別に発見し、個別に公開し、使いこなすには高度なプログラミング知識が必要だった。一般のペネトレーションテスターには、手が届かない世界だった。

H.D. Moore氏は、これを変えた。

Metasploitは、世界中のエクスプロイトを一つのフレームワークに統合した。2,200以上のエクスプロイト。600以上のペイロード。脆弱性を選び、ターゲットを指定し、実行する。それだけで、システムに侵入できる。

> 「Metasploitがなければ、ペネトレーションテストは今でも一部のエリートだけの技術だっただろう」

2009年にRapid7社に買収されたが、コア部分はオープンソースのまま。世界中のセキュリティ専門家が、今もこれを使っている。

---

## Cobalt Strike — 本物の攻撃者をシミュレートする

Metasploitは強力だ。しかし、現実の攻撃者はもっと巧妙だ。

Raphael Mudge氏は考えた。「本物のAPT（高度な持続的脅威）をシミュレートするには、もっと洗練されたツールが必要だ」

2012年、Cobalt Strikeが生まれた。

年間約4,000ドルのライセンス費用。にもかかわらず、世界中のレッドチームがこれを使う。なぜか。

通信を完全にカスタマイズできる。正規のトラフィックに偽装できる。複数のオペレーターが同時に操作できる。現実の攻撃者が使うテクニックを、すべて再現できる。

皮肉なことに、本物の攻撃者もこのツールを使う。流出したバージョンが闘市場で出回り、実際のサイバー攻撃で使用されている。

---

## Empire — PowerShellの闇の力

Windowsには、PowerShellという強力なスクリプト言語が組み込まれている。

システム管理者のための便利なツール。しかし、攻撃者から見れば、これ以上ない武器だ。

2015年、Will Schroeder氏らはPowerShell Empireを開発した。完全にメモリ上で動作し、ディスクに痕跡を残さない。アンチウイルスに検出されにくい。Windowsの正規機能を使っているから。

> 「最も危険な攻撃は、正規のツールを悪用する攻撃だ」

---

## Sliver — オープンソースの反撃

Cobalt Strikeは優秀だが、高価だ。そして、ライセンス管理が厳しい。

Bishop Fox社は、オープンソースの代替を作った。Sliver。

無料で、オープンソースで、Cobalt Strikeに匹敵する機能を持つ。レッドチームの民主化、第二章。

---

## これらのツールで何ができるのか

- 発見した脆弱性を実際に悪用し、システムに侵入する
- 侵入後、さらに深くネットワーク内を移動する（ラテラルムーブメント）
- 検出を避けながら、長期間アクセスを維持する
- 本物の攻撃者と同じ手法で、組織の防御力をテストする

これらのツールの存在を知ることは、防御側にとっても重要だ。

攻撃者がどんな武器を持っているか知らなければ、どう守ればいいかわからない。
